-# @expects: local 'slot_name'
!!!
%html
  %head
  %body{:style => "margin: 0px; padding: 0px;"}
    - case slot_name
      - when "slot_leaderboard"
        - zone_name = ( get_setting('openx_zone_leaderboard').try(:value) || "2")
      - when "slot_small_square"
        - zone_name = ( get_setting('openx_zone_small_square').try(:value) || "3")
      - when "slot_skyscraper"
        - zone_name = ( get_setting('openx_zone_skyscraper').try(:value) || "4")
      - when "slot_square"
        - zone_name = ( get_setting('openx_zone_square').try(:value) || "5")
      - when "slot_medium_rectangle"
        - zone_name = ( get_setting('openx_zone_medium_rectangle').try(:value) || "6")
      - when "slot_large_rectangle"
        - zone_name = ( get_setting('openx_zone_large_rectangle').try(:value) || "7")
      - else
        - zone_name = ( get_setting('openx_zone_banner').try(:value) || "1")
    %script{:type => "text/javascript"}
      <!--
      var m3_u = '#{get_setting('openx_url_m3_u').try(:value)}';
      var m3_r = Math.floor(Math.random()*99999999999);
      var zone_name = #{zone_name};
      if (!document.MAX_used) document.MAX_used = ',';
      document.write ("<scr"+"ipt type='text/javascript' src='"+m3_u);
      document.write ("?zoneid=" + zone_name);
      document.write ('&amp;cb=' + m3_r);
      if (document.MAX_used != ',') document.write ("&amp;exclude=" + document.MAX_used);
      document.write (document.charset ? '&amp;charset='+document.charset : (document.characterSet ? '&amp;charset='+document.characterSet : ''));
      document.write ("&amp;loc=" + escape(window.location));
      if (document.referrer) document.write ("&amp;referer=" + escape(document.referrer));
      if (document.context) document.write ("&context=" + escape(document.context));
      if (document.mmm_fo) document.write ("&amp;mmm_fo=1");
      document.write ("'><\/scr"+"ipt>");
      // -->
    %noscript
      %a{:href => get_setting('openx_noscript_href').try(:value), :target => '_blank'}
      %img{:src => get_setting('openx_noscript_imgsrc').try(:value), :border => '0', :alt => ''}
